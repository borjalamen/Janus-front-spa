<div class="profile-container">
  <!-- Header con botón volver -->
  <div class="profile-header">
    <button class="back-btn" (click)="goBack()">
      <mat-icon>arrow_back</mat-icon>
      Volver a Administración
    </button>
    <h1>Perfil de Usuario</h1>
  </div>

  <!-- Loading state -->
  <div *ngIf="loading" class="loading-state">
    <mat-icon class="spin">sync</mat-icon>
    <p>Cargando información del usuario...</p>
  </div>

  <!-- Error state -->
  <div *ngIf="error && !loading" class="error-state">
    <mat-icon>error_outline</mat-icon>
    <p>No se pudo cargar la información del usuario</p>
    <button class="back-btn" (click)="goBack()">Volver</button>
  </div>

  <!-- User Profile Content -->
  <div *ngIf="user && !loading" class="profile-content fade-in">
    
    <!-- Sección principal: Avatar e info básica -->
    <div class="profile-main-card">
      <div class="profile-avatar">
        <span class="avatar-initials">{{ getInitials() }}</span>
      </div>
      
      <div class="profile-basic-info">
        <h2 class="user-name">{{ user.fullName }}</h2>
        <p class="user-position">{{ user.position || 'Sin cargo definido' }}</p>
        <div class="user-roles">
          <span *ngFor="let rol of user.roles" class="role-badge">{{ getRolLabel(rol) }}</span>
        </div>
        <p class="user-status" [class.active]="user.status === 'ACTIVE'" [class.inactive]="user.status !== 'ACTIVE'">
          <mat-icon>{{ user.status === 'ACTIVE' ? 'check_circle' : 'cancel' }}</mat-icon>
          {{ user.status === 'ACTIVE' ? 'Activo' : 'Inactivo' }}
        </p>
      </div>

      <!-- Botón descargar CV -->
      <div class="cv-section" *ngIf="user.cvPath">
        <button class="download-cv-btn" (click)="downloadCV()">
          <mat-icon>download</mat-icon>
          Descargar CV (PDF)
        </button>
      </div>
    </div>

    <!-- Información detallada tipo curriculum -->
    <div class="profile-details">
      
      <!-- Información de Contacto -->
      <div class="detail-card">
        <h3><mat-icon>contact_mail</mat-icon> Información de Contacto</h3>
        <div class="detail-row">
          <span class="detail-label">Email:</span>
          <span class="detail-value">{{ user.email }}</span>
        </div>
        <div class="detail-row" *ngIf="user.phone">
          <span class="detail-label">Teléfono:</span>
          <span class="detail-value">{{ user.phone }}</span>
        </div>
        <div class="detail-row" *ngIf="user.location">
          <span class="detail-label">Ubicación:</span>
          <span class="detail-value">{{ user.location }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Usuario:</span>
          <span class="detail-value">{{ user.username }}</span>
        </div>
      </div>

      <!-- Experiencia Profesional -->
      <div class="detail-card">
        <h3><mat-icon>work</mat-icon> Experiencia Profesional</h3>
        <div class="detail-row">
          <span class="detail-label">Años de Experiencia:</span>
          <span class="detail-value highlight">{{ user.experienceYears ?? 'No especificado' }} {{ user.experienceYears ? 'años' : '' }}</span>
        </div>
        <div class="detail-row" *ngIf="user.proyectos">
          <span class="detail-label">Proyectos Completados:</span>
          <span class="detail-value highlight">{{ user.proyectos }}</span>
        </div>
        <div class="detail-row" *ngIf="user.department">
          <span class="detail-label">Departamento:</span>
          <span class="detail-value">{{ user.department }}</span>
        </div>
        <div class="detail-row" *ngIf="user.joinDate">
          <span class="detail-label">Fecha de incorporación:</span>
          <span class="detail-value">{{ user.joinDate }}</span>
        </div>
      </div>

      <!-- Habilidades -->
      <div class="detail-card" *ngIf="user.skills && user.skills.length > 0">
        <h3><mat-icon>psychology</mat-icon> Habilidades Técnicas</h3>
        <div class="skills-grid">
          <span *ngFor="let skill of user.skills" class="skill-tag">{{ skill }}</span>
        </div>
      </div>

      <!-- Certificaciones -->
      <div class="detail-card" *ngIf="user.certifications && user.certifications.length > 0">
        <h3><mat-icon>verified</mat-icon> Certificaciones</h3>
        <ul class="certifications-list">
          <li *ngFor="let cert of user.certifications">
            <mat-icon>emoji_events</mat-icon>
            {{ cert }}
          </li>
        </ul>
      </div>

      <!-- Formación -->
      <div class="detail-card" *ngIf="user.education">
        <h3><mat-icon>school</mat-icon> Formación Académica</h3>
        <p class="education-text">{{ user.education }}</p>
      </div>

      <!-- Biografía -->
      <div class="detail-card bio-card" *ngIf="user.bio">
        <h3><mat-icon>person</mat-icon> Sobre mí</h3>
        <p class="bio-text">{{ user.bio }}</p>
      </div>

    </div>
  </div>
</div>
